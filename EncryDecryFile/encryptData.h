#ifndef _ENCRYPT_DATA_H_
#define _ENCRYPT_DATA_H_


#ifdef __cplusplus
extern "C" {
#endif


#define FILENAMELENTH  1024
typedef struct _encry_handle encryHandle_t;

/*加密; 采用公钥
*@param : str 加密数据地址
*@param : len 加密数据长度
*@param : publicPathKey 指定加密数据公钥
*@retval: success encrypt Data address; fail NULL;
*/
char* my_encrypt_publicKey(char *str, int lenth, char *publicPathKey);


/*解密; 采用私钥;
*@param : str 加密数据地址
*@param : len 加密数据长度
*@param : privatePathKey 指定解密数据私钥
*@retval: success encrypt Data address; fail NULL;
*/
char* my_decrypt(char *str, int lenth, int *deDataLenth, char *privatePathKey);


/*加密; 采用证书; 证书与公钥的不同之处在于: 证书中包含 公钥和 其他申请人信息
*@param : str 加密数据地址
*@param : len 加密数据长度
*@param : publicPathKey 指定加密数据公钥
*@retval: success encrypt Data address; fail NULL;
*/
char* my_encrypt_publicCert(char *str, int lenth, int *enDataLenth, char *publicPathKey);

/*加密文件
*@param : filePath 		文件的绝对路径
*@param : publicPathKey 指定加密数据公钥
*@retval: success 0, fail -1;
*/
int encryptFileData(char *filePath, char *publicPathKey);

/*解密文件
*@param : filePath 		 文件的绝对路径
*@param : privatePathKey 指定解密数据私钥
*@retval: success 0, fail -1;
*/
int decryptFileData(char *filePath, char *privatePathKey);




/*获取剩余文件的 加密所需的最小线程数(即剩余文件的最小工作轮次) 以及 (所有线程工作量)最后剩余的文件大小
*@param : filePath 		 	 文件路径
*@param : threadNum 		 	 该文件所需工作线程的数量
*@param : lowRoundNum 		 所需线程的最小工作轮次
*@param : baseSize 		 	 文件计算的分割基数
*@param : size				 最后剩余文件大小
*@retval: success 解密数据长度; fail -1;
*/
int get_residueSize_needThreadNum(char *filePath, int threadNum, 
	int lowRoundNum, int baseSize, int *size);

/*拼装加密后的文件名
*@param : filePath   		原始文件绝对路径或相对路径(或文件名)
*@param : encFileName   	加密后文件绝对路径或相对路径(或文件名)
*/
void package_encry_file_name(char *filePath, char *encFileName);

/*组装 解密文件名
*@param : filePath   		原始文件绝对路径或相对路径(或文件名)
*@param : decFileName   	加密后文件绝对路径或相对路径(或文件名)
*/
void package_decry_file_name(char *filePath, char *decFileName);

/*初始化, 全局变量, 工作线程池
*@retval: success : 工作线程池 ; fail : NULL
*/
void *init();

/* 解密文件线程工作 方法
*@param : arg : 参数句柄
*/
void decry_process(void *arg);

/* 加密文件线程工作 方法
*@param : arg : 参数句柄
*/
void encry_process(void *arg);

/*多线程解密文件接口
*@param : filePath 		 文件的绝对路径
*@param : privatePathKey 指定解密数据私钥
*@param : pool 			 工作线程池
*@retval: success 0, fail -1;
*/
int multiDecryFile(char *filePath, char *privatePathKey, void *pool);


int multiDecryFile_inFileFp(char *filePath, char *privatePathKey, void *pool);

/*销毁程序: 工作线程池, 全局变量
*@param : pool 			 工作线程池
*@retval: success 0; fail -1;
*/
int destroy(void *pool );

/*对称加密算法加密文件, AES
*@param : file 		 	 原始文件的绝对路径
*@param : passwd 		 指定加密文件的数据秘钥
*@retval: success 0, fail -1;
*/
int encry_file_AES(char *file, char *passwd);

/*对称加密算法解密文件, AES
*@param : file 		 	 原始文件的绝对路径
*@param : passwd 		 指定加密文件的数据秘钥
*@retval: success 0, fail -1;
*/
int decry_file_AES(char *file, char *passWdSrc);


int mix_RSA_AES_decryFile(char *file, char *privatePathKey);

int mix_RSA_AES_encryFile(char *file, char *passWdSrc, char *publicPathKey);

#ifdef __cplusplus
}
#endif

#endif
